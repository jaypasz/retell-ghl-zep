# =============================================================================
# Environment Configuration for Retell-GHL-Zep Integration (Optimized)
# =============================================================================

# -----------------------------------------------------------------------------
# Zep Memory Configuration
# -----------------------------------------------------------------------------
ZEP_API_KEY=your_zep_api_key_here
ZEP_API_URL=https://api.getzep.com

# -----------------------------------------------------------------------------
# Go High Level (GHL) CRM Configuration
# -----------------------------------------------------------------------------
GHL_API_KEY=your_ghl_api_key_here
GHL_LOCATION_ID=your_ghl_location_id_here
GHL_CALENDAR_ID=your_ghl_calendar_id_here
GHL_TIMEZONE=America/New_York

# -----------------------------------------------------------------------------
# Retell AI Configuration
# -----------------------------------------------------------------------------
RETELL_API_KEY=your_retell_api_key_here

# -----------------------------------------------------------------------------
# Redis Cache Configuration (OPTIMIZATION)
# -----------------------------------------------------------------------------
# Local development: redis://localhost:6379
# Production (Railway/Heroku): redis://user:password@host:port
# Leave empty to disable Redis optimization
REDIS_URL=redis://localhost:6379

# -----------------------------------------------------------------------------
# Supabase Database Configuration (OPTIMIZATION)
# -----------------------------------------------------------------------------
# Get these from your Supabase project settings > API
# Leave empty to disable Supabase features
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your_supabase_anon_or_service_key_here

# -----------------------------------------------------------------------------
# Langfuse Observability (Optional)
# -----------------------------------------------------------------------------
# For prompt management and tracing
LANGFUSE_PUBLIC_KEY=your_langfuse_public_key_here
LANGFUSE_SECRET_KEY=your_langfuse_secret_key_here
LANGFUSE_BASE_URL=https://us.cloud.langfuse.com

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
# Railway sets PORT automatically - only needed for local development
PORT=8000

# =============================================================================
# OPTIMIZATION SETUP INSTRUCTIONS
# =============================================================================

# 1. REDIS SETUP
# --------------
# Local Development:
#   docker run -d -p 6379:6379 redis:alpine
#
# Railway Deployment:
#   1. Add Redis plugin in Railway dashboard
#   2. Railway will auto-set REDIS_URL environment variable
#
# Upstash (Serverless Redis):
#   1. Create account at https://upstash.com
#   2. Create Redis database
#   3. Copy connection string to REDIS_URL

# 2. SUPABASE SETUP
# -----------------
# 1. Create account at https://supabase.com
# 2. Create new project
# 3. Go to Project Settings > API
# 4. Copy:
#    - Project URL -> SUPABASE_URL
#    - anon/public key -> SUPABASE_KEY (for basic use)
#    - service_role key -> SUPABASE_KEY (for admin operations)
# 5. Run the SQL schema in Supabase SQL Editor:
#    - Copy contents of supabase_schema.sql
#    - Paste into SQL Editor and run

# 3. PERFORMANCE EXPECTATIONS
# ---------------------------
# Without optimization (legacy mode):
#   - Webhook response: 500-600ms
#   - Blocking on all external APIs
#
# With Redis only:
#   - First call: 150-200ms (cache miss)
#   - Subsequent calls: 50-100ms (cache hit)
#
# With Redis + Supabase (full optimization):
#   - First call: 80-100ms (cache miss, parallel fetching)
#   - Subsequent calls: 30-50ms (cache hit)
#   - Background tasks: 200-400ms (non-blocking)
#
# With full context cache:
#   - Cached calls: 30-50ms (instant response)
#   - Cache refresh in background
#   - 90%+ cache hit rate after warmup

# 4. DEPLOYMENT CHECKLIST
# -----------------------
# [ ] Install dependencies: pip install -r requirements.txt
# [ ] Set all required environment variables
# [ ] Set up Redis (local/Railway/Upstash)
# [ ] Set up Supabase and run schema
# [ ] Test locally: uvicorn main:app --reload
# [ ] Deploy to Railway
# [ ] Monitor logs for optimization metrics
# [ ] Check Redis cache hit rates
# [ ] Verify webhook response times < 100ms
